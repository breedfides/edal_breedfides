<!doctype html>
<html lang="en">
  <head>

    <title>$title - $repositoryNameShort</title>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery.min.js"><\/script>')</script>
    <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.datatables.net/buttons/1.5.2/js/dataTables.buttons.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.datatables.net/buttons/1.5.2/js/buttons.html5.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap4.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.11/lodash.min.js"></script>

    #parse("de/ipk_gatersleben/bit/bi/edal/primary_data/HeaderTemplate.xml")

    <link rel="stylesheet" href="$serverURL/CSS/report.css">

      <style>
        div#report_wrapper {
            height: 100%;
            box-sizing: border-box;
            margin-bottom:0px;
        }
      </style>
	#if( $MatomoTemplate)
		$MatomoTemplate
	#end

  </head>

  <body>
    <div id="search-counter"></div>
    <div id="grid-container">
      <nav>
  <div class="container-fluid">
      <div class="row header">
          <div class="col my-auto"><a target="_blank" href="http://edal.ipk-gatersleben.de"><img id="logo-edal" src="$serverURL/LOGO/edal_logo.png" /></a></div>
          <div id="edal-report-title-long" class="col-auto text-center my-auto">$repositoryNameLong</div>
          <div id="edal-report-title-short" class="col-auto text-center my-auto">$repositoryNameShort</div>
          #if( $InstituteLogo)
  <div class="col text-right pt-1"><a target="_blank" href="$publisherUrl"><img id="logo-ipk" src="/institute_logo.png" /></a></div>
  #else
  <div class="col text-right pt-1"><a target="_blank" href="$publisherUrl"><img id="logo-ipk" src="$serverURL/LOGO/ipk_logo.jpg" /></a></div>
      #end

      </div>
        </div>
      </nav>
        <div id="controls" class="pt-2 pb-2">
            <div class="pl-3 form-row" style="color:white;text-shadow:2px 2px 2px rgba(0,0,0,0.2);">
              <span class="flex-col h2 mr-1">Search</span>
              <div class="flex-col pt-1">
                <span class="form-control form-control-sm" id="collapseButton" style="background-color: transparent;border-color: transparent;color:white;cursor: pointer;font-size:large" type="button" name="collapseButton" onclick="collapse()" >+</span>
              </div>
              <span class="col h6 collapsible" id="statisticsSpan" style="display:inline-block;">
                <div class="content" id="collapsible-content">

                  <div class="form-row" style="max-width:800px">
                    <div class="col">
                        <label class="h5" for="scales">Fuzzy</label>
                    </div>
                    <div class="col">
                      <input class="form-control form-control-sm" style="min-height:1%" type="checkbox" id="fuzzy" name="scales">
                    </div>

                    <div class="col">
                      <label class="h5" for="fname">Type:</label>
                    </div>

                    <div class="col">
                      <select class="form-control form-control-sm" id="element" name="element" size="1" style="min-width:120px" onchange="EdalReport.typeChange()">
                        <option value="Title">Title/Filename</option>
                        <option>Description</option>
                        <option>Creator</option>
                        <option>Legalperson</option>
                        <option>Subject</option>
                        <option>Language</option>
                        <option>Filetype</option>
                        <option>Checksum</option>
                        <option value="Allfields">Search All types</option>
                      </select>
                    </div>

                    <div class="col">
                      <label class="h5" style="white-space: nowrap;">Search term:</label>
                    </div>

                    <div class="col">
                      <input class="form-control form-control-sm" list="auto-complete" style="min-width:150px;height:28px" id="searchterm" type="text" name="searchterm">
                        <datalist id="auto-complete"></datalist>
                      </input>
                    </div>

                    <div class="col">
                      <select class="form-control form-control-sm" id="occur" name="occur" size="1" style="min-width:135px">
                        <option value="MUST">Must occur</option>
                        <option value="SHOULD">May occur</option>
                        <option value="MUST_NOT">Must not occur</option>
                      </select>
                    </div>

                    <div class="col">
                      <button class="form-control form-control-sm" id="addButton" type="button" name="button"  onclick="EdalReport.build()">+</button>
                    </div>

                  </div>
                </div>
                </span>
            </div>
            <div class="px-3 clearfix" style="background:rgba(255,255,255,0.2);padding:4px 0 3px 0;">
                <div class="mr-5" style="display:inline-block;color:white;">
                  <div class="form-row" style="max-width:900px">
                    <div class="col">
                      <input class="form-control form-control-sm clearable" style="min-width:700px" id="query" type="text" name="query" placeholder="Search..."></input>
                    </div>

                    <div class="col">
                      <button class="form-control form-control-sm" id="searchButton" type="button" name="searchbutton" onclick="EdalReport.search()" >search</button>
                    </div>
                    <div class="col">
                        <div class="lds-ellipsis" id="loading-indicator" style="display:none"><div></div><div></div><div></div><div></div></div>
                    </div>
                  </div>
                    <!-- <div id="edal-report-filter-container" class="mr-3">
                        <span class="mr-2">Filter:</span>
                        <select id="edal-report-year-filter">
                            <option value="All">All</option>
                        </select>
                    </div> -->
                </div>
            </div>
        </div>

        <div id="grid-container-table-and-map">
            <div id="edal-report-table-container" class="px-3" style="overflow-y: hidden;">
              <div id="edal-report-table-inner-container">
                <div id="edal-report-filter" class="mt-2">


                <div class="creation-label centerclass">
                  Creation date
                  <input type="checkbox" onchange="EdalReport.filterChange()" name="Ongoing" id="period" class="ml-1">
                </div>

                <div class="datepickerlowcontainer centerclass">
                  <input type="date" onchange="EdalReport.filterChange()" class="form-control form-control-sm centerclass" id="datepickerlow" disabled name="start"
                   value="2018-07-22"
                   min="1980-01-01" max="2018-12-31">
                </div>

                <div class="datepickerhighcontainer centerclass">
                  <input type="date" onchange="EdalReport.filterChange()" class="form-control form-control-sm centerclass" id="datepickerhigh" disabled name="end"
                    value="2018-07-22"
                    min="1980-01-01">
                </div>

                    <div class="hittypelabel centerclass">
                      <label for="">Result types</label>
                    </div>
                    <div class="hittypeinput centerclass">
                      <select class="form-control form-control-sm" id="hitType" name="top5" size="1">
                        <option value="rootDirectory">Records</option>
                        <option value="singleData">Files</option>
                        <option value="directory">Directories</option>
                      </select>
                    </div>

                    <div class="filetypelabel centerclass">
                      <label for="">File Extension </label>
                      <input id="suffix" onchange="EdalReport.filterChange()" type="checkbox" class="mb-1 ml-1" name="Ongoing"  >
                    </div>
                    <div class="filetypeinput centerclass">
                      <select id="suffixesSelect" onchange="EdalReport.filterChange()" class="form-control form-control-sm" disabled name="top5" size="1">
                        #foreach($obj in $filetypes)
                          <option value="$obj">$obj</option>
                         #end
                      </select>
                    </div>

                    <div class="filesizelabel centerclass">
                      <label for="">File size </label>
                      <input id="filesize" onchange="EdalReport.filterChange()" class="mb-1 ml-1" type="checkbox" name="Ongoing"  >
                    </div>
                    <div class="filesizeinputs">
                      <div class="filesizeinputnumbers centerclass">
                        <input id="filesizelow" onchange="EdalReport.filterChange()" class = "halfinput form-control form-control-sm" disabled type="number" name="" value="">
                        <input id="filesizehigh" onchange="EdalReport.filterChange()" class = "halfinput form-control form-control-sm" disabled type="number" name="" value="">
                      </div>
                      <div class="filesizeinputnumbers centerclass">
                        <select id="filesizelowbyte" onchange="EdalReport.filterChange()" class="form-control form-control-sm" disabled name="top5" size="1">
                          <option>B</option>
                          <option>KB</option>
                          <option>MB</option>
                          <option>GB</option>
                          <option>TB</option>
                        </select>
                        <select id="filesizehighbyte" onchange="EdalReport.filterChange()" class="form-control form-control-sm" disabled name="top5" size="1">
                          <option>B</option>
                          <option>KB</option>
                          <option>MB</option>
                          <option>GB</option>
                          <option>TB</option>
                        </select>
                      </div>
                    </div>

                </div>
                <div class="pl-3 mt-1 " >
                  <div id="result-stats"></div>
                </div>
                <div id="table-column" class="pl-3">
                  <table id="report" class="table table-hover table-bordered table-sm" width="100%"></table>
                </div>
              </div>
            </div>
        </div>

        <footer class="footer">
            <div class="container">
                <span class="text-muted">e!DAL-Server at $serverURL.getHost():$serverURL.getPort()</span>
            </div>
        </footer>
    </div>


    <!-----------------------------------
    -------- Edal Report Javascript -------
    -------------------------------------->
    <script src="$serverURL/JS/edal_search.js"></script>

    <script>
        var serverURL = "$serverURL";
        //var reportData = $json;
        //var mapData = $jsonall;
        var reportData = [];
        var mapData = [];
        var filetypes = [];
        var limit = 8;
        #foreach($obj in $filetypes)
          filetypes.push("$obj");
         #end
    </script>

    <script>
    EdalReport.init(reportData, mapData);

    function collapse(){
      var element = document.getElementsByClassName("collapsible");
      var content = document.getElementById("collapsible-content");
      if (content.style.display === "block") {
        content.style.display = "none";
        document.getElementById("collapseButton").innerHTML = "+";
      } else {
        content.style.display = "block";
        document.getElementById("collapseButton").innerHTML = '&#8722';
      }
    }

    $('#period').change(function() {
      $('#datepickerlow').prop('disabled', !this.checked);
      $('#datepickerhigh').prop('disabled', !this.checked);
    });

    $('#suffix').change(function() {
      $('#suffixesSelect').prop('disabled', !this.checked);
    });

    $('#filesize').change(function() {
      $('#filesizelow').prop('disabled', !this.checked);
      $('#filesizehigh').prop('disabled', !this.checked);
      $('#filesizelowbyte').prop('disabled', !this.checked);
      $('#filesizehighbyte').prop('disabled', !this.checked);
    });

    </script>

  </body>
</html>
