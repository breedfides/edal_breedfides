<!doctype html>
<html lang="en">
<head>

    <title>Metadata - $entity.getVersionByDate($date).getName()</title>

    #parse("de/ipk_gatersleben/bit/bi/edal/primary_data/HeaderTemplate.xml")
	
	#parse("de/ipk_gatersleben/bit/bi/edal/primary_data/MetaTagTemplate.xml")
		
	#parse("de/ipk_gatersleben/bit/bi/edal/primary_data/MatamoTemplate.xml")

</head>
<body>

<div id="grid-container"> 

		#parse("de/ipk_gatersleben/bit/bi/edal/primary_data/JsonLdTemplate.xml")
		
		#parse("de/ipk_gatersleben/bit/bi/edal/primary_data/TopSectionTemplate.xml")

    <div id="controls" class="pt-2 pb-4">
        <div class="px-3 clearfix" id="edal-detail-quote-wrapper">
            <div id="edal-detail-quote-container">
                <span class="mr-2">Please always quote when using data:</span>
                <span id="edal-detail-quote-bar">
                    <a href="$serverURL/$identifierType/$internalId/$citation_entity.getID()/$citation_entity.getVersionByDate($date).getRevision()/BIBTEX" class="btn btn-outline-light btn-sm edal-detail-quote-btn" role="button">BibTeX</a>
                    <a href="$serverURL/$identifierType/$internalId/$citation_entity.getID()/$citation_entity.getVersionByDate($date).getRevision()/RIS" class="btn btn-outline-light btn-sm edal-detail-quote-btn" role="button">RIS</a>
                    <a href="$serverURL/$identifierType/$internalId/$citation_entity.getID()/$citation_entity.getVersionByDate($date).getRevision()/RDFXML" class="btn btn-outline-light btn-sm edal-detail-quote-btn" role="button">RDF/XML</a>
                    <a href="$serverURL/$identifierType/$internalId/$citation_entity.getID()/$citation_entity.getVersionByDate($date).getRevision()/RDFTURTLE" class="btn btn-outline-light btn-sm edal-detail-quote-btn" role="button">RDF/Turtle</a>
                    <a href="$serverURL/$identifierType/$internalId/$citation_entity.getID()/$citation_entity.getVersionByDate($date).getRevision()/TEXT" class="btn btn-outline-light btn-sm edal-detail-quote-btn" role="button">Text</a>
                    <a href="$serverURL/$identifierType/$internalId/$citation_entity.getID()/$citation_entity.getVersionByDate($date).getRevision()/SCHEMA" class="btn btn-outline-light btn-sm edal-detail-quote-btn" role="button">JSON-LD</a>
                </span>
            </div>
        </div>
    </div> 

	#foreach( $element in $citation_entity.getVersionByDate($date).getPublicReferences())
				#if(! $element.getAssignedID())
					#set ($link="false")
				#else
					#set ($link="true")
					#set ($doi=$element.getAssignedID())
				#end
		#end

    <div id="grid-container-content" style="overflow-y: auto;padding-bottom:20px;">

        <div class="container-fluid mt-2 px-2">
            <div class="row">
                <div class="col">

                    <div class="card">
                        <div class="card-body p-3 pb-1">

                            <p class="my-0">
                                <span style="font-weight:500;">Citation:</span>
                                #if($link=="true")
									<a target="_blank" href ="https://search.datacite.org/works/$doi">$citation_entity.getVersionByDate($date).getMetaData().toString()
										#foreach($element in $citation_entity.getVersionByDate($date).getPublicReferences())
											#if($link=="true")
												$element.getIdentifierType():$element.getAssignedID()
											#end
										#end
										 </a>
									#else
									$citation_entity.getVersionByDate($date).getMetaData().toString()
									#end
                            </p>
                            
                            <p class="my-0 mt-2">
                                <span style="font-weight:500;">Abstract: </span>$citation_entity.getVersionByDate($date).getMetaData().getElementValue($description)
                            </p>

                            <p class="my-0 mt-2">
                                <span style="font-weight:500;">License: </span><a href="#">$citation_entity.getVersionByDate($date).getMetaData().getElementValue($rights).toHTML()</a>
                            </p>

                            <p class="my-0 mt-1">
                            #if($link=="true")
	                            #foreach($element in $citation_entity.getVersions().last().getPublicReferences())
	                                <span style="font-weight:500;">$element.getIdentifierType():</span>  
									$element.getAssignedID()
								#end
							#end
                            </p>
                            <p class="my-0 mt-1">
                                <span style="font-weight:500;">Content: </span>$referenceDirectoryContent Directories $referenceFileContent Files ($referenceDataVolume)
                            </p>

                        </div>
                    </div>

                    <div class="card mt-2">
                        <div class="card-body p-3">
                            <h6>Files:</h6>
                            <div id="edal-detail-path">
                                $entity.switchCurrentVersion($entity.getVersionByDate($date))$entity.getPath() <span style="font-weight:500;">[$directorynumber Directories $filenumber Files]</span>
                            </div>

							#if($entity.getParentDirectory().toString() != "/")
							<div id="edal-detail-directory-up">
								<a
									href="$serverURL/$identifierType/$internalId/$entity.getParentDirectory().getID()/$entity.getParentDirectory().getVersionByDate($date).getRevision()/">Up to parent directory</a>
							</div>
							#end
                            
                            
                            <div id="edal-detail-directory-table-wrapper">
                                <table id="edal-detail-directory-table">
                                    #parse("de/ipk_gatersleben/bit/bi/edal/primary_data/TreeTemplateForSnapshot.xml")
                                </table>
                            </div>

                            <a href="$downloadURL/$identifierType/$internalId/$entity.getID()/$entity.getVersionByDate($date).getRevision()/ZIP" role="button" class="mt-3 btn btn-outline-primary btn-sm"><span class="oi oi-data-transfer-download" title="icon name" aria-hidden="true"></span> Download as ZIP</a>
                            
                        </div>
                    </div>

                </div>
            </div>
            <div class="row mt-2" id="edal-metadata-details">
                <div class="col">

                    <div class="card p-3">
                        <h6>Metadata</h6>

                        <div class="container-fluid p-0">
                            <div class="row">
                                <div class="col-lg">

                                    <table class="table table-bordered table-sm">
                                       	#parse("de/ipk_gatersleben/bit/bi/edal/primary_data/MetadataDirectoryTemplatePart1.xml")
                                    </table>

                                </div>
                                <div class="col-lg">

                                    <table class="table table-bordered table-sm">
                                        #parse("de/ipk_gatersleben/bit/bi/edal/primary_data/MetadataDirectoryTemplatePart2.xml")
                                    </table>

                                </div>
                            </div>
                        </div>
                            
                    </div>
                </div>
            </div>
        </div>

    </div>

    <footer class="footer">
        <div class="container">
            <span class="text-muted">Revision: $entity.getVersionByDate($date).getRevision() - CreationDate: $entity.getVersionByDate($date).getCreationDate().getTime() - RevisionDate: $entity.getVersionByDate($date).getRevisionDate().getTime()</span>
        </div>
    </footer>
</div>

<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>

<script>
    $(function () { 
        $('#edal-contributor-show-full').click(function(event) {
            event.preventDefault();
            $('#edal-contributor-long').show();
            $('#edal-contributor-short').hide();
        });
        $('#edal-contributor-hide-full').click(function(event) {
            event.preventDefault();
            $('#edal-contributor-long').hide();
            $('#edal-contributor-short').show();
        });
         $('#edal-creator-show-full').click(function(event) {
            event.preventDefault();
            $('#edal-creator-long').show();
            $('#edal-creator-short').hide();
        });
        $('#edal-creator-hide-full').click(function(event) {
            event.preventDefault();
            $('#edal-creator-long').hide();
            $('#edal-creator-short').show();
        });
        
    });
</script>

</body>
</html>